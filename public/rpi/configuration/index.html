<!DOCTYPE html>
<html>
  <head>
    <title>Meine Hugo Seite</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.49.2" />

<title>Rpi einrichten :: Meine Hugo Seite</title>
<link rel="shortcut icon" href="../../images/favicon.png" type="image/x-icon" />
<link href="../../css/nucleus.css" rel="stylesheet">
<link href="../../css/font-awesome.min.css" rel="stylesheet">
<link href="../../css/hybrid.css" rel="stylesheet">
<link href="../../css/featherlight.min.css" rel="stylesheet">
<link href="../../css/auto-complete.css" rel="stylesheet">
<link href="../../theme-original/style.css" rel="stylesheet">

<link rel="stylesheet" href="../../css/bootstrap.min.css">
<script src="../../js/jquery-2.x.min.js"></script>
<style type="text/css">
  :root #header + #content > #left > #rlblock_left {
    display:none !important;
  }
</style>
<meta name="description" content="Grundkonfiguration des Pi">


    
  </head>
  <body data-url="/rpi/configuration/">
    
      <div id="headermain"></div>
<nav id="sidebar" class="showVisitedLinks">



<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
      
	
  
    <p>Blume Dokumentation</p>

  

    </div>
        <div class="searchbox">
		    <label for="search-by"><i class="fa fa-search"></i></label>
		    <input data-search-input id="search-by" type="text" placeholder="">
		    <span data-search-clear=""><i class="fa fa-close"></i></span>
		</div>
		<script type="text/javascript" src="../../js/lunr.min.js"></script>
		<script type="text/javascript" src="../../js/auto-complete.js"></script>
		<script type="text/javascript">
        
            var baseurl = "\/";
        
		</script>
		<script type="text/javascript" src="../../js/search.js"></script>
  </div>

      <ul class="topics">
            <li data-nav-id="/" class="dd-item">
            <a href="../../"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/netzwerk/" class="dd-item haschildren
        ">
      <div>
      <a href="../../netzwerk/">IT-Struktur</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/netzwerk/fritzbox/" class="dd-item">
        <div>
          <a href="../../netzwerk/fritzbox/">
            FritzBox
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/netzwerk/nginx/" class="dd-item haschildren
        ">
      <div>
      <a href="../../netzwerk/nginx/">Revers-Proxy</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/netzwerk/nginx/letsencrypt/" class="dd-item">
        <div>
          <a href="../../netzwerk/nginx/letsencrypt/">
            Let´s Encrypt
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netzwerk/nginx/servername/" class="dd-item">
        <div>
          <a href="../../netzwerk/nginx/servername/">
            Server Ports und Namen
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netzwerk/nginx/location/" class="dd-item">
        <div>
          <a href="../../netzwerk/nginx/location/">
            Server Unterodrner (locations)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netzwerk/nginx/proxy/" class="dd-item">
        <div>
          <a href="../../netzwerk/nginx/proxy/">
            HTTP Proxy
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netzwerk/nginx/gitlab_domain_subfolder/" class="dd-item">
        <div>
          <a href="../../netzwerk/nginx/gitlab_domain_subfolder/">
            GitLab hinter nginx-Revers-Proxy
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/netzwerk/webserver/" class="dd-item
        ">
      <div>
      <a href="../../netzwerk/webserver/">WebServer</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/docker/" class="dd-item haschildren
        ">
      <div>
      <a href="../../docker/">docker</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docker/rpi_install_docker/" class="dd-item">
        <div>
          <a href="../../docker/rpi_install_docker/">
            Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/docker/rpi_install_compose/" class="dd-item">
        <div>
          <a href="../../docker/rpi_install_compose/">
            Installation docker-compose
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/docker/swarm/" class="dd-item">
        <div>
          <a href="../../docker/swarm/">
            swarm
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/docker/cluster/" class="dd-item">
        <div>
          <a href="../../docker/cluster/">
            cluster
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/docker/container/" class="dd-item haschildren
        ">
      <div>
      <a href="../../docker/container/">container</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/docker/container/rpi-hugo/" class="dd-item">
        <div>
          <a href="../../docker/container/rpi-hugo/">
            rpi-hugo
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/docker/container/certbot/" class="dd-item">
        <div>
          <a href="../../docker/container/certbot/">
            certbot-rpi
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/docker/container/pi-hole/" class="dd-item">
        <div>
          <a href="../../docker/container/pi-hole/">
            pi-hole
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/rpi/" class="dd-item parent haschildren
        ">
      <div>
      <a href="../../rpi/">Raspberry Pi</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/rpi/configuration/" class="dd-item active">
        <div>
          <a href="../../rpi/configuration/">
            Rpi einrichten
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/rpi/ssh_key/" class="dd-item">
        <div>
          <a href="../../rpi/ssh_key/">
            SSH und keys
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/rpi/rpimonitor/" class="dd-item">
        <div>
          <a href="../../rpi/rpimonitor/">
            RPi-Monitor
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/rpi/tricks/" class="dd-item">
        <div>
          <a href="../../rpi/tricks/">
            tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>



        <section id="shortcuts">
                <li class="" role=""><h3>More</h3><a href="https://github.com/Grembold/myHugoLP" target="_blank" rel="noopener"><i class='fa fa-github'></i> Github repo</a></li>
                <li class="" role=""><a href="http://docdock.netlify.com/" target="_blank" rel="noopener"><i class='fa fa-bookmark'></i> Docdock Documentation</a></li>
                <li class="" role=""><a href="../../impressum/" target="_blank" rel="noopener"><i class='fa fa-bullhorn'></i> Impressum</a></li>
                <li class="" role=""><a href="../../links/" target="_blank" rel="noopener"><i class='fa fa-external-link-square'></i> Links</a></li>
        </section>
            <a id="clear-history" class="" href="#" data-clear-history-toggle=""><i class="fa  fa-history"></i> </a>

    <hr />
    <li></li>
    
    </ul>

 <section id="footer">
    </section>
  </div>
</nav>



<section id="body">
<div id="overlay"></div>
<div class="padding highlightable">

  <div id="top-bar">
    
      
      
      
    <div id="top-github-link">
      <a class="github-link" href="https://github.com/Grembold/myHugoLP/edit/master/content/rpi/configuration.md" target="blank">
        <i class="fa fa-code-fork"></i>
        
      </a>
    </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
          <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
            <i class="fa fa-bars"></i>
          </a>
        </span>
        <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
        <span class="links">
        







 <a href='../../'>DocDock für Blume</a> > <a href='../../rpi/'>Raspberry Pi</a> > Rpi einrichten

 

 

   
        </span>
    </div>
    
    
    <div class="progress">
        <div class="wrapper">
    <nav id="TableOfContents">
<ul>
<li><a href="#grundkonfiguration">Grundkonfiguration</a>
<ul>
<li><a href="#teil-2-ssh-schlüssel-neu-erstellen">Teil 2 - SSH-Schlüssel neu erstellen</a></li>
<li><a href="#teil-3-software-aktualisierung">Teil 3 - Software-Aktualisierung</a></li>
<li><a href="#teil-4-rpi-firmware-linux-kernel-aktualisieren">Teil 4 - RPI Firmware / Linux kernel aktualisieren</a></li>
<li><a href="#teil-5-swap-deaktivieren">Teil 5 - Swap deaktivieren</a></li>
<li><a href="#teil-6-logging-in-arbeitsspeicher-verschieben">Teil 6 - Logging in Arbeitsspeicher verschieben</a></li>
</ul></li>
</ul>
</nav>
        </div>
    </div>
    

  </div>


<div id="body-inner">
  
    <h1>Rpi einrichten</h1>
  



    
    
    
    

<h1 id="grundkonfiguration">Grundkonfiguration</h1>

<p>Der erste Schritt für jeden Pi ist ersteinmal das Raspbian image auf eine SD-Karte zu spielen.
Da es hierzu unzälige anleitungen gibt, sei es hier nur erwähnt und abgehakt.</p>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> Betriebssystem auf SD-Karte spielen</label></li>
</ul>

<p>Der zweite Schritt ist die raspi-config Erste einstellungen vornehmen</p>

<pre><code>sudo raspi-config
</code></pre>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> Passwort des users pi ändern

<ul>
<li><code>2 change user password</code></li>
</ul></label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Dateisystem erweitern

<ul>
<li><code>9 Advanced Options</code></li>
<li><code>A1 Expand filesstem</code></li>
</ul></label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Boot-Option auswählen

<ul>
<li><code>3 Boot Options</code></li>
<li><code>B1 Console</code></li>
</ul></label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Sprach- und Zeiteinstellungen

<ul>
<li><code>#4 Internationalisation Options</code></li>
<li><code>I1 Change Local</code></li>
<li><code>[x] de_DE.UTF-8 UTF-8 aktivieren</code></li>
<li><code>[ ] en_EN... deaktivieren</code></li>
<li><code>de_DE als default</code></li>
<li><code>I2 Change Timezone</code></li>
<li><code>Europe -&gt; Berlin</code></li>
</ul></label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Hostname ändern

<ul>
<li><code>9 Advanced Options</code></li>
<li><code>A2 Hostname</code></li>
</ul></label></li>
</ul>

<p>Zum Schluss lässtig, aber wichtig, der reboot.</p>

<pre><code>sudo reboot
</code></pre>

<h2 id="teil-2-ssh-schlüssel-neu-erstellen">Teil 2 - SSH-Schlüssel neu erstellen</h2>

<p>Da wir ein frisches Image verwendet haben und dies alle im Internet verwenden, ist auch der SSH fingerprint bei alles gleich. Also lassen wir diesen einmal neu erstellen</p>

<pre><code>:::shell
sudo rm /etc/ssh/ssh_host_*
sudo dpkg-reconfigure openssh-server
sudo service ssh restart
</code></pre>

<h2 id="teil-3-software-aktualisierung">Teil 3 - Software-Aktualisierung</h2>

<pre><code>:::shell
sudo apt update
sudo apt upgrade
sudo reboot
</code></pre>

<h2 id="teil-4-rpi-firmware-linux-kernel-aktualisieren">Teil 4 - RPI Firmware / Linux kernel aktualisieren</h2>

<p>Anzeige der aktuellen Linux version
    uname -a
Anzeige der Hardware
    sudo cat /proc/device-tree/model
Update</p>

<pre><code>:::shell
sudo rpi-update
sudo reboot
</code></pre>

<p>Sollte von jessy auf stretch gewechselt werden, so müssen die Paketquellen entsprechend angepasst werden. <a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2204031.htm">Siehe hier</a></p>

<pre><code>sudo nano /etc/apt/sources.list
    deb http://raspbian.raspberrypi.org/raspbian/ stretch main contrib non-free rpi
</code></pre>

<h2 id="teil-5-swap-deaktivieren">Teil 5 - Swap deaktivieren</h2>

<p><a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2002131.htm">Swapping beim Raspberry pi deaktivieren</a>
&gt; Speziell beim Raspberry Pi ist Swapping eigentlich kontraproduktiv. Swapping erhöht die Anzahl der Schreibzugriffe auf ein Speichermedium, auf dem sich der Swap-Speicher befindet. Das Betriebssystem und der Swap-Speicher befindet sich beim Raspberry Pi auf einer SD-Card, die nur eine begrenzte Anzahl an Schreibzugriffen verträgt, bevor einzelne Speicherzellen kaputt gehen. SD-Cards eignen sich überhaupt nicht zum Swapping.
&gt; Ein weiterer Grund auf Swapping zu verzichten ist die begrenzte Geschwindigkeit der SD-Card. Das macht das Swapping auf dem Raspberry Pi auch noch langsam.
&gt; Auch SSDs verkraften nur eine begrenzte Anzahl von Schreibzyklen. Auf eine SSD oder SD-Card zu swappen reduziert deren Lebensdauer und kann zu vorzeitigem Datenverlust führen</p>

<p>Zuerst stoppen des Swapping-Dienst</p>

<pre><code>sudo service dphys-swapfile stop
</code></pre>

<p>Anschließend prüfen wir, ob das Swapping abgeschaltet ist:</p>

<pre><code>free -h
</code></pre>

<p>Wenn die Zeile &ldquo;Swap&rdquo; nur noch &ldquo;0&rdquo;-Werte aufweist, können wir den Swap-Dienst deaktivieren.</p>

<pre><code>sudo systemctl disable dphys-swapfile
</code></pre>

<h2 id="teil-6-logging-in-arbeitsspeicher-verschieben">Teil 6 - Logging in Arbeitsspeicher verschieben</h2>

<p>Häufiges schreiben auf die SD-Karte kann dies vorzeitig zertören und im schliommsten fall die Installation unbrauchbar machen. Dies ist mir auch schon einige male in den Jahren passiert. Das Raspberry scheint noch normal zu funktionieren und die Dienste und Programme laufen noch, doch lässt die SD-Karte keine schreibenden Zugriff mehr zu und alle Änderungen sind nach einem Neustart wieder futsch.
Ein Teil im Raspberry der regelmäßig auf die SD-Karte schreibt sind die Dienste (Daemons). Alle abschalten wäre eine Möglichkeit, doch dann hat der Pi gar keine gunktion mehr :-).
Eine andere Möglichkeit ist das Logging-Verzeichniss auf einen anderen Datenträger auszulagern. Ein Speicher der sehr viele schreib-Zugriff verträgt ist der RAM und mit einer virtuellen Festplatte im RAM lässt dich das Logging-Verzeichnis dorthin verschieben.
Nun sind die Daten im RAM bekanntlicher weise nach einem Absturz/Neustart verloren und nun wären auch alle Logs verloren. Dies möchte man natürlich nicht und so erstellt man einen Dienst der regelmässig und beim ordendlichen herunterfahren/neustart alle Logs aus dem Arbeitsspeicher wieder auf die SD-Karte schreibt. Hierdurch wird der schreibzugriff aud die SD-Karte erheblich reduziert.</p>

<p>{%alert%}
In einigen Blogs und Seiten wird das Tool <code>ramlog</code> verwednet. Ich musste aber feststellen, dasss es mit der Debian Version Stretch nicht mehr funktioniert. Also <code>ramlog</code>und <code>strechts</code> sind nicht kompatiebel.{%alert%}</p>

<p>Am einfachsten war für mich das tool <a href="https://github.com/azlux/log2ram"><code>log2ram</code></a>, dessen isntallation auf dem Raspberry ich hier aufführe.</p>

<pre><code>curl -Lo log2ram.tar.gz https://github.com/azlux/log2ram/archive/master.tar.gz
tar xf log2ram.tar.gz
cd log2ram-master
chmod +x install.sh &amp;&amp; sudo ./install.sh
cd ..
rm -r log2ram-master

sudo reboot
</code></pre>

<p>Quelle: <a href="https://github.com/azlux/log2ram">https://github.com/azlux/log2ram</a></p>


    
    
          <footer class=" footline" >
	
</footer>
  </div>
</div>

<div id="navigation">
<a class="nav nav-prev" href="../../rpi/" title="Raspberry Pi"> <i class="fa fa-chevron-left"></i><label>Raspberry Pi</label></a>
    <a class="nav nav-next" href="../../rpi/ssh_key/" title="SSH und keys" style="margin-right: 0px;"><label>SSH und keys</label><i class="fa fa-chevron-right"></i></a></div>

</section>
<div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
  <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
</div>    

<script src="../../js/clipboard.min.js"></script>
<script src="../../js/featherlight.min.js"></script>
<script src="../../js/html5shiv-printshiv.min.js"></script>

<script src="../../js/modernizr.custom.71422.js"></script>
<script src="../../js/docdock.js"></script>
<script src="../../theme-original/script.js"></script>


    

    
    

    
  </body>
</html>